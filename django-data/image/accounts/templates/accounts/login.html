{% extends "base.html" %}
{% load staticfiles %}

{%  block custom-css %}
  {# You need to load staticfiles in order to call static templatetag #}
  <link rel="stylesheet" href="{% static 'css/accounts.css' %}">
  <link rel="stylesheet" href="{% static 'css/login.css' %}">
{% endblock %}

{% block title_block %}
  Please Sign-In
{% endblock title_block %}

{% block body %}

<body class="text-center">

  {% if form.errors %}
    <div class="alert alert-dismissible alert-danger">
      <button type="button" class="close" data-dismiss="alert">&times;</button>
      <strong>Your username and password didn't match: </strong>
      Please try again.
    </div>
  {% endif %}

  {% if next %}
      {# USer authenticated but has no access to that page (ie not staff user)#}
      {% if user.is_authenticated %}
      <div class="alert alert-dismissible alert-warning">
        <button type="button" class="close" data-dismiss="alert">&times;</button>
        <h4 class="alert-heading">Warning!</h4>
        <p class="mb-0">Your account doesn't have access to this page. To proceed,
        please login with an account that has access.</p>
      </div>

      {# This appens when I need to authenticate myself to see this page #}
      {% else %}
        <div class="alert alert-dismissible alert-primary">
          <button type="button" class="close" data-dismiss="alert">&times;</button>
          Please login to see this page.
        </div>
      {% endif %}

  {% endif %}

  <div class="container">
    <form class="form-signin" action="{% url 'login' %}" method='post'>
      {% csrf_token %}
      <img class="mx-auto img-fluid" src="/image/static/images/image_logo.png" alt="image log" width="300px" height='auto'>
      <h1 class="h3 mb-3 font-weight-normal">Please sign in</h1>

      <label for="username" class="sr-only">Username:</label>
      <input type="text" id="username" class="form-control" name="username" placeholder="Username" required autofocus>

      <label for="password" class="sr-only">Password:</label>
      <input type="password" id="password" class="form-control" name="password" placeholder="Password" required>

      <!--
      <div class="checkbox mb-3">
        <label>
          <input type="checkbox" value="remember-me"> Remember me
        </label>
      </div>
      -->
      <button class="btn btn-lg btn-primary btn-block" type="submit" value="login">Sign in</button>
      <div class="card-footer text-muted text-center">
        New to IMAGE-InjectTool? <a href="{% url 'signup' %}">Sign up</a>
      </div>
      <div class="text-center py-2">
        <small>
          <a href="{% url 'accounts:password_reset' %}" class="text-muted">Forgot your password?</a>
        </small>
      </div>
      <p class="mb-3 text-muted">&copy; 2017-2018</p>
      <input type="hidden" name="next" value="{{ next }}" />
    </form>
  </div>

  <!-- Optional JavaScript -->
  {% block custom-js %}{% endblock custom-js %}

  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

</body>

{% endblock body %}
